# はじめに
## 本書の目的

本プロジェクトで使用するAWSサービス及び外部サービスを定める


## 関連資料
本書の前提となる資料、情報元となる資料は以下の通り。  

* [非機能要件一覧](https://docs.google.com/spreadsheets/d/1B5z5-YWOrzDnu0gY5AM-_wRCRX9LD9EZ/edit?usp=share_link&ouid=106375452255861814726&rtpof=true&sd=true)
* [構築ガイドライン](https://drive.google.com/file/d/1KaAbHae4c2WQy37im2Ujmpvk_nD-QD8-/view?usp=share_link)
* [クラウドセキュリティガイドライン](https://docs.google.com/document/d/1uHi7mWWJaxotaLL3iJ90vqa7ZCzF9PId/edit?usp=share_link&ouid=106375452255861814726&rtpof=true&sd=true)
* [POHR論理システム構成図](https://app.diagrams.net/#G122z8inmGkVqX_vwh6zkzKVSDbcr20eBX)

# 対象非機能要件
本書に関連する対象非機能要件は以下の通り。

|大項目|項番|定義項目|決定メトリクス|備考|
|---|---|---|---|---|
|可用性|A.1.1.1<br>A.1.1.2|運用スケジュール|24時間無停止|　|
|可用性|A.1.2.2|サービス切替時間|60分未満|　|
|可用性|A.1.2.3|業務継続の要求度|単一障害時は業務停止を許容せず、処理を継続させる|・単一の定義<br>単一の定義をZONE・基盤の種類とする<br>（マルチリージョンや、DRは準備しない想定）　|
|可用性|A.4.1.1|復旧作業|復旧用製品による復旧|各種サーバにおいて、冗長構成にし、AWS機能にて自動フェイルオーバーを実現|
|性能・拡張性|B.3.5.1|サーバ処理能力増強|DBサーバ、バッチサーバのスケールアップを可能とする|スケールアップを容易に実現可能なRDS、ECS、AWS Batch等のマネージドサービスを活用|
|性能・拡張性|B.3.5.2|サーバ処理能力増強|全サーバのスケールアウトを可能とする。|・WEBサーバ、APPサーバ<br>AWSサービスにて負荷状況に応じた自動スケールアウト可能なインフラ構成にする。<br>・DBサーバ、バッチサーバ<br>手動にてスケールアウト対応を行う。|
|性能・拡張性|B.4.3.1|スパイク負荷対応|トランザクション保護＝同時トランザクション数の制限機能|APPサーバに同時トランザクションの制限を設ける|
|セキュリティ|E.1.1.1|情報セキュリティに関するコンプライアンス|順守すべき社内規程、ルール、法令、ガイドライン等有|LION様策定のクラウドセキュリティガイドライン、構築ガイドラインを従った設計|
|セキュリティ|E.6.1.2|蓄積データの暗号化の有無|重要情報を暗号化|AWSのKMSサービスを用いてS3やDBのデータの暗号化を実施する|
|セキュリティ|E.7.1.1|ログの取得|実施する| |
|セキュリティ|E.7.1.3|不正監視対象（装置）|重要度が高い資産を扱う範囲、あるいは、外接部分|サーバへの不正アクセスはCloudfrareにて検知する|
|セキュリティ|E.7.1.5|不正監視対象（侵入者・不正操作等）|重要度が高い資産を扱う範囲、あるいは、外接部分|対象AWSアカウントに対する内部からの不正操作について、AWSのCloudTrail、GuardDutyにて検知する|
|セキュリティ|E.8.3.1|ネットワークの輻輳対策|有り|AWS Shieldサービスの利用し、対策を実施する|
|セキュリティ|E.10.1.2|WAFの導入の有無|有り|Cloudflare導入|
|システム環境・エコロジー|F.1.1.1/F.1.2.1|構築/運用時の制約条件|制約有り(重要な制約のみ適用)|LION様提供のAWSクラウドセキュリティガイドライン、AWS構築ガイドライン|

## WEBサーバー
|種別|利用AWSサービス | 備考 |
|------- |--------------- | ------------------------------ |
|ー| Cloudfront+S3 | 静的コンテンツ配信のスケーラビリティの観点から左記サービスを選定 |
## APIリクエスト受付サーバー
|種別|利用AWSサービス | 備考 |
|------- |--------------- | ------------------------------ |
|外部通信| API Gateway | DMZ層として外部からのアクセスはAPI Gatewayサービスを選定 |
|内部通信| ALB | public層としてシステム間からのアクセスはALBサービスを選定 |

## 認証・認可サーバー
|対象システム|利用AWSサービス | 備考 |
|------- |--------------- | ------------------------------ |
|各ZONE| Cognito | マネージドサービスの積極採用の観点からユーザの認証・認証としてCognitoサービスを選定 |
## APPサーバー
|種別|利用AWSサービス | 備考 |
| --------------- | ------------------------------ |
| オンライン処理 | Lambda | アーキテクチャ共通にて定めた方針（冗長性、マネージドサービスの積極採用、負荷分散）の観点と処理時間の観点 |

## キャッシュサーバー
|種別|利用AWSサービス | 備考 |
| --------------- | ------------------------------ |
| ー | ElastiCache | アプリケーション処理のパフォーマンス向上の観点からElastiCacheを選定 |
## DBサーバー

## バッチサーバー
|種別|利用AWSサービス | 備考 |
| 処理時間の短いバッチ処理 | Lambda  | アーキテクチャ共通にて定めた方針（冗長性、マネージドサービスの積極採用、負荷分散）及び処理時間の観点から選定。<br>処理時間30分以内:Lambda|
| 処理時間の長いバッチ処理 | Fargate  | アーキテクチャ共通にて定めた方針（冗長性、マネージドサービスの積極採用、負荷分散）及び処理時間の観点から選定。<br>処理時間30分以上:Fargate|

## ファイルサーバー

## 監視サーバー

## DNSサーバー

## 踏み台サーバー

## パッチ管理サーバー

## 外部サービス
### WAF(Web Application Firewall)
### DOS(Denial of Service Attack)対策
### KMS
### CloudTrail
### GuardDuty
### AWS Shield
### Amazon Certificate　Manager